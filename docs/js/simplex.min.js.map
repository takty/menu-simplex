{"version":3,"sources":["simplex.js"],"names":["window","id","MenuSimplex","static","throttle","fn","isRunning","run","requestAnimationFrame","addHoverStateEventListener","root","elms","enter","e","li","target","parentElement","pointerType","classList","contains","CLS_CURRENT","add","CLS_HOVER","elm","tagName","CLS_HOVER_ANCESTOR","leave","remove","it","fec","firstElementChild","addEventListener","fixBackground","enabled","fixed","se","document","scrollingElement","documentElement","sy","scrollTop","parseInt","body","style","top","cs","getComputedStyle","ss","position","left","width","parseFloat","marginInlineStart","marginInlineEnd","height","key","value","Object","entries","scrollTo","getStylePropertyBool","prop","v","getPropertyValue","trim","length","Boolean","JSON","parse","toLowerCase","getStylePropertyString","replace","RegExp","String","divRoot","ulBar","ulFld","liFocusTrap","fldIdx","scrollY","curIts","skipResize","constructor","this","getElementById","getElementsByClassName","NS","getElementsByTagName","DOMException","initFolder","its","initBarItems","initPopup","order","initOrder","initFocusTrap","allLis","Array","from","querySelectorAll","setTimeout","ro","ResizeObserver","closeAll","alignItems","observe","CLS_READY","idx","children","CLS_FOLDER","createElement","pos","CP_FOLDER_POS","append","prepend","btn","querySelector","appendChild","ul","lis","popup","nextElementSibling","offsetWidth","push","setAttribute","CLS_OPENED","close","open","stopPropagation","focus","click","CP_IS_CLOSED_AUTO","doOnScroll","passive","ws","i","getWeightFromClass","sort","a","b","CP_IS_REVERSED","reverse","def","className","split","w","c","n","isNaN","tabIndex","CLS_ACTIVE","transform","adjustPopupInline","CP_IS_BG_FIXED","maxWidth","pr","getBoundingClientRect","rr","right","pop","removeChild","opening","bcr","bottom","Math","abs","setMaxWidth","inBar","calcItemPlace","CP_IS_FOLDABLE","fill","display","prevElm","firstChild","insertBefore","p","s","clientWidth","paddingLeft","paddingRight","setProperty","CP_MAX_WIDTH","floor","gap","calcBarGap","sumW","reduce","barW","calcBarWidth","endsWith","flexGrow","g","columnGap","Number"],"mappings":"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","file":"simplex.min.js","sourcesContent":["/**\n * Menu Simplex (Progressively collapsing menu)\n *\n * @author Takuto Yanagida\n * @version 2023-09-24\n */\n\nwindow['menu_simplex'] = function (id = null) {\n\tnew MenuSimplex(id);\n};\n\nclass MenuSimplex {\n\n\tstatic NS = 'menu-simplex';\n\n\tstatic CP_IS_FOLDABLE    = '--is-foldable';\n\tstatic CP_IS_CLOSED_AUTO = '--is-closed-auto';\n\tstatic CP_IS_BG_FIXED    = '--is-background-fixed';\n\tstatic CP_IS_REVERSED    = '--is-reversed';\n\tstatic CP_FOLDER_POS     = '--folder-position';\n\n\tstatic CLS_FOLDER  = 'folder';\n\tstatic CLS_CURRENT = 'current';\n\n\tstatic CLS_READY          = 'ready';\n\tstatic CLS_HOVER          = 'hover';\n\tstatic CLS_HOVER_ANCESTOR = 'hover-ancestor';\n\tstatic CLS_ACTIVE         = 'active';\n\tstatic CLS_OPENED         = 'opened';\n\n\tstatic CP_MAX_WIDTH = '--max-width';\n\n\n\t// -------------------------------------------------------------------------\n\n\n\tstatic throttle(fn) {\n\t\tlet isRunning;\n\t\tfunction run() {\n\t\t\tisRunning = false;\n\t\t\tfn();\n\t\t}\n\t\treturn () => {\n\t\t\tif (isRunning) return;\n\t\t\tisRunning = true;\n\t\t\trequestAnimationFrame(run);\n\t\t};\n\t}\n\n\tstatic addHoverStateEventListener(root, elms) {\n\t\tconst enter = e => {\n\t\t\tconst li = e.target.parentElement;\n\n\t\t\tif (li && e.pointerType === 'mouse' && !li.classList.contains(MenuSimplex.CLS_CURRENT)) {\n\t\t\t\tli.classList.add(MenuSimplex.CLS_HOVER);\n\t\t\t\tfor (let elm = li.parentElement; elm && elm !== root; elm = elm.parentElement) {\n\t\t\t\t\tif (elm.tagName === 'LI') {\n\t\t\t\t\t\telm.classList.add(MenuSimplex.CLS_HOVER_ANCESTOR);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tconst leave = e => {\n\t\t\tconst li = e.target.parentElement;\n\n\t\t\tif (li && e.pointerType === 'mouse' && !li.classList.contains(MenuSimplex.CLS_CURRENT)) {\n\t\t\t\tli.classList.remove(MenuSimplex.CLS_HOVER);\n\t\t\t\tfor (let elm = li.parentElement; elm && elm !== root; elm = elm.parentElement) {\n\t\t\t\t\tif (elm.tagName === 'LI') {\n\t\t\t\t\t\telm.classList.remove(MenuSimplex.CLS_HOVER_ANCESTOR);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (const it of elms) {\n\t\t\tconst fec = it.firstElementChild;\n\t\t\tif (fec) {\n\t\t\t\tfec.addEventListener('pointerenter', enter);\n\t\t\t\tfec.addEventListener('pointerleave', leave);\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic fixed;\n\n\tstatic fixBackground(enabled) {\n\t\tif (MenuSimplex.fixed === enabled) return;\n\t\tMenuSimplex.fixed = enabled;\n\n\t\tconst scrollingElement = () => {\n\t\t\treturn ('scrollingElement' in document) ? document.scrollingElement : document.documentElement;\n\t\t};\n\t\tconst se = scrollingElement();\n\t\tif (!se) return;\n\t\tconst sy = enabled ? se.scrollTop : parseInt(document.body.style.top ?? '0');\n\t\tconst cs = getComputedStyle(document.body);\n\t\tconst mw = parseFloat(cs.marginInlineStart) + parseFloat(cs.marginInlineEnd);\n\t\tconst ss = {\n\t\t\tposition: 'fixed',\n\t\t\ttop     : `${-sy}px`,\n\t\t\tleft    : '0',\n\t\t\twidth   : `calc(100vw - ${mw}px)`,\n\t\t\theight  : '100dvh',\n\n\t\t\t'overflow-y': 'scroll',  // For keeping scroll bar width.\n\t\t};\n\t\tfor (const [key, value] of Object.entries(ss)) {\n\t\t\tdocument.body.style[key] = enabled ? value : '';\n\t\t}\n\t\tif (!enabled) {\n\t\t\twindow.scrollTo(0, -sy);\n\t\t}\n\t}\n\n\tstatic getStylePropertyBool(elm, prop) {\n\t\tconst v = getComputedStyle(elm).getPropertyValue(prop).trim();\n\t\tif (!v.length) return null;\n\t\tif (typeof v !== 'string') return Boolean(v);\n\t\ttry {\n\t\t\treturn 'true' == JSON.parse(v.toLowerCase());\n\t\t} catch(e) {\n\t\t\treturn v.length !== 0;\n\t\t}\n\t}\n\n\tstatic getStylePropertyString(elm, prop) {\n\t\tconst v = getComputedStyle(elm).getPropertyValue(prop).trim().replace(new RegExp('^\\\"+|\\\"+$', 'g'), '');\n\t\tif (!v.length) return null;\n\t\treturn (typeof v === 'string') ? v : String(v);\n\t}\n\n\n\t// -------------------------------------------------------------------------\n\n\n\t#divRoot;\n\t#ulBar;\n\t#ulFld;\n\t#liFocusTrap;\n\n\t#fldIdx;\n\n\t#scrollY = 0;\n\t#curIts  = [];\n\n\t#skipResize = false;\n\n\tconstructor(id = null) {\n\t\tthis.#divRoot = id ? document.getElementById(id) : document.getElementsByClassName(MenuSimplex.NS)[0];\n\t\tif (!this.#divRoot) return;\n\t\tthis.#ulBar = this.#divRoot.getElementsByTagName('ul')[0];\n\t\tif (!this.#ulBar) throw new DOMException();\n\n\t\t[this.#ulFld, this.#fldIdx] = this.initFolder();\n\t\tconst its = this.initBarItems();\n\t\tthis.initPopup(its);\n\t\tconst order = this.initOrder(its);\n\t\tthis.#liFocusTrap = this.initFocusTrap();\n\n\t\tconst allLis = Array.from(this.#ulBar.querySelectorAll('li'));\n\t\tMenuSimplex.addHoverStateEventListener(this.#divRoot, allLis);\n\n\t\tsetTimeout(() => {\n\t\t\tconst ro = new ResizeObserver(\n\t\t\t\t() => requestAnimationFrame(() => {\n\t\t\t\t\tif (this.#skipResize) {\n\t\t\t\t\t\tthis.#skipResize = false;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis.closeAll(its);\n\t\t\t\t\tthis.alignItems(its, order);\n\t\t\t\t})\n\t\t\t);\n\t\t\tro.observe(this.#divRoot);\n\t\t\tro.observe(this.#divRoot.parentElement);\n\t\t}, 10);\n\t\tsetTimeout(() => this.#divRoot.classList.add(MenuSimplex.CLS_READY), 100);\n\t}\n\n\tinitFolder() {\n\t\tlet li  = null;\n\t\tlet idx = 0;\n\t\tfor (const e of this.#ulBar.children) {\n\t\t\tif (e.classList.contains(MenuSimplex.CLS_FOLDER)) {\n\t\t\t\tli = e;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tidx += 1;\n\t\t}\n\t\tif (!li) {\n\t\t\tli = document.createElement('li');\n\t\t\tli.classList.add(MenuSimplex.CLS_FOLDER);\n\n\t\t\tconst pos = MenuSimplex.getStylePropertyString(this.#divRoot, MenuSimplex.CP_FOLDER_POS);\n\t\t\tif (null === pos || 'end' === pos) {\n\t\t\t\tthis.#ulBar.append(li);\n\t\t\t\tidx = this.#ulBar.children.length - 1;\n\t\t\t} else if ('start' === pos) {\n\t\t\t\tthis.#ulBar.prepend(li);\n\t\t\t\tidx = 0;\n\t\t\t}\n\t\t}\n\t\tlet btn = li.querySelector(':scope > button');\n\t\tif (!btn) {\n\t\t\tbtn = document.createElement('button');\n\t\t\tli.appendChild(btn);\n\t\t}\n\t\tlet ul = li.querySelector(':scope > button + ul, :scope > button + * > ul');\n\t\tif (!ul) {\n\t\t\tul = document.createElement('ul');\n\t\t\tul.classList.add('menu');\n\t\t\tli.appendChild(ul);\n\t\t}\n\t\treturn [ul, idx];\n\t}\n\n\tinitBarItems() {\n\t\tconst its = [];\n\t\tconst lis = Array.from(this.#ulBar.querySelectorAll(':scope > li'));\n\t\tfor (const li of lis) {\n\t\t\tconst btn = li.querySelector(':scope > button');\n\t\t\tconst popup = btn?.nextElementSibling;\n\t\t\tconst width = li.offsetWidth;\n\t\t\tits.push({ li, btn, popup, width });\n\t\t}\n\t\treturn its;\n\t}\n\n\tinitPopup(its) {\n\t\tfor (const it of its) {\n\t\t\tconst { li, btn, popup } = it;\n\t\t\tif (!btn || !popup) continue;\n\n\t\t\tbtn.setAttribute('area-expanded', 'false');\n\t\t\tif (!popup.id) {\n\t\t\t\tconst id = btn.id ? btn.id : (li.id ? li.id : '');\n\t\t\t\tif (id) {\n\t\t\t\t\tpopup.id = id + '-sub';\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (popup.id) {\n\t\t\t\tbtn.setAttribute('area-controls', popup.id);\n\t\t\t}\n\t\t\tbtn.addEventListener('click', e => {\n\t\t\t\tif (btn.classList.contains(MenuSimplex.CLS_OPENED)) {\n\t\t\t\t\tthis.close(it);\n\t\t\t\t} else {\n\t\t\t\t\tif (this.#ulBar === li.parentElement) {\n\t\t\t\t\t\tthis.closeAll(its, btn);\n\t\t\t\t\t}\n\t\t\t\t\tthis.open(it);\n\t\t\t\t}\n\t\t\t\te.stopPropagation();\n\t\t\t});\n\t\t}\n\t\twindow.addEventListener('keydown', e => {\n\t\t\tif (e.key === 'Escape') {\n\t\t\t\tif (this.#curIts.length) {\n\t\t\t\t\tconst btn = this.#curIts[this.#curIts.length - 1].btn;\n\t\t\t\t\tif (btn) {\n\t\t\t\t\t\tbtn.focus();\n\t\t\t\t\t\tbtn.click();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tif (true === MenuSimplex.getStylePropertyBool(this.#divRoot, MenuSimplex.CP_IS_CLOSED_AUTO)) {\n\t\t\tdocument.addEventListener('DOMContentLoaded', () => {\n\t\t\t\twindow.addEventListener('scroll', MenuSimplex.throttle(() => this.doOnScroll(its)), { passive: true });\n\t\t\t});\n\t\t\tdocument.addEventListener('click', () => this.closeAll(its));\n\t\t}\n\t}\n\n\tinitOrder(its) {\n\t\tconst ws = new Array(its.length);\n\t\tfor (let i = 0; i < its.length; i += 1) {\n\t\t\tconst { li } = its[i];\n\t\t\tws[i] = this.getWeightFromClass(li, its.length - i);\n\t\t}\n\t\tconst order = new Array(its.length);\n\t\tfor (let i = 0; i < its.length; i += 1) order[i] = i;\n\t\torder.sort((a, b) => ws[a] < ws[b] ? 1 : ws[a] > ws[b] ? -1 : 0);\n\n\t\tif (true === MenuSimplex.getStylePropertyBool(this.#divRoot, MenuSimplex.CP_IS_REVERSED)) {\n\t\t\torder.reverse();\n\t\t}\n\t\treturn order;\n\t}\n\n\tgetWeightFromClass(li, def) {\n\t\tconst cs = li.className.split(' ');\n\t\tlet w = null;\n\t\tfor (const c of cs) {\n\t\t\tconst n = parseInt(c, 10);\n\t\t\tif (isNaN(n)) continue;\n\t\t\tif (null === w || w < n) w = n;\n\t\t}\n\t\treturn w ?? def;\n\t}\n\n\tinitFocusTrap() {\n\t\tconst e = document.createElement('li');\n\t\te.className = 'focus-trap';\n\t\te.tabIndex = 0;\n\t\te.addEventListener('focus', () => {\n\t\t\tif (this.#curIts.length) {\n\t\t\t\tconst { btn } = this.#curIts[0];\n\t\t\t\tif (btn) btn.focus();\n\t\t\t}\n\t\t});\n\t\treturn e;\n\t}\n\n\n\t// -------------------------------------------------------------------------\n\n\n\topen(it) {\n\t\tconst { li, btn, popup } = it;\n\t\tif (!btn || !popup) return;\n\n\t\tli.classList.add(MenuSimplex.CLS_OPENED);\n\t\tbtn.classList.add(MenuSimplex.CLS_OPENED);\n\t\tbtn.setAttribute('area-expanded', 'true');\n\t\tpopup.classList.add(MenuSimplex.CLS_ACTIVE);\n\n\t\tsetTimeout(() => popup.classList.add(MenuSimplex.CLS_OPENED), 0);\n\t\tthis.#curIts.push(it);\n\n\t\tpopup.style.transform = '';\n\t\tif (this.#curIts[0].popup) {\n\t\t\tthis.adjustPopupInline(this.#curIts[0].popup);\n\t\t}\n\t\tthis.#scrollY = window.scrollY;\n\n\t\tif (1 === this.#curIts.length) {\n\t\t\tconst ul = ('UL' === popup.tagName) ? popup : popup.getElementsByClassName('UL')?.[0];\n\t\t\tif (ul) {\n\t\t\t\tul.appendChild(this.#liFocusTrap);\n\t\t\t}\n\t\t}\n\n\t\tif (true === MenuSimplex.getStylePropertyBool(this.#divRoot, MenuSimplex.CP_IS_BG_FIXED)) {\n\t\t\tthis.#skipResize = true;\n\t\t\tMenuSimplex.fixBackground(true);\n\t\t}\n\t}\n\n\tadjustPopupInline(popup) {\n\t\tpopup.style.transform = '';\n\t\tpopup.style.maxWidth = '';\n\t\tlet pr = popup.getBoundingClientRect();\n\t\tconst rr = this.#divRoot.getBoundingClientRect();\n\t\tif (rr.width < pr.width) {\n\t\t\tpopup.style.maxWidth = `${rr.width}px`;\n\t\t\tpr = popup.getBoundingClientRect();\n\t\t}\n\t\tif (rr.right < pr.right) {\n\t\t\tpopup.style.transform = `translateX(${rr.right - pr.right}px)`;\n\t\t}\n\t\tif (pr.left < rr.left) {\n\t\t\tpopup.style.transform = `translateX(${pr.left - rr.left}px)`;\n\t\t}\n\t}\n\n\tclose(it) {\n\t\tconst { li, btn, popup } = it;\n\t\tif (!btn || !popup) return;\n\n\t\tli.classList.remove(MenuSimplex.CLS_OPENED);\n\t\tbtn.classList.remove(MenuSimplex.CLS_OPENED);\n\t\tbtn.setAttribute('area-expanded', 'false');\n\t\tpopup.classList.remove(MenuSimplex.CLS_OPENED);\n\n\t\tsetTimeout(() => {\n\t\t\tpopup.classList.remove(MenuSimplex.CLS_ACTIVE);\n\t\t\tif (this.#curIts.length) {\n\t\t\t\tconst { popup } = this.#curIts[0];\n\t\t\t\tif (popup) this.adjustPopupInline(popup);\n\t\t\t}\n\t\t}, 200);\n\t\tthis.#curIts.pop();\n\n\t\tif (0 === this.#curIts.length) {\n\t\t\tconst ul = ('UL' === popup.tagName) ? popup : popup.getElementsByClassName('UL')?.[0];\n\t\t\tif (ul && this.#liFocusTrap.parentElement === ul) {\n\t\t\t\tul.removeChild(this.#liFocusTrap);\n\t\t\t}\n\t\t}\n\n\t\tif (MenuSimplex.getStylePropertyBool(this.#divRoot, MenuSimplex.CP_IS_BG_FIXED)) {\n\t\t\tthis.#skipResize = true;\n\t\t\tMenuSimplex.fixBackground(false);\n\t\t}\n\t}\n\n\tcloseAll(its, opening = null) {\n\t\tif (!this.#curIts.length) return;\n\n\t\tfor (const it of its) {\n\t\t\tconst { btn } = it;\n\t\t\tif (btn && opening !== btn) {\n\t\t\t\tthis.close(it);\n\t\t\t}\n\t\t}\n\t\tthis.#curIts.length = 0;\n\n\t\tif (MenuSimplex.getStylePropertyBool(this.#divRoot, MenuSimplex.CP_IS_BG_FIXED)) {\n\t\t\tthis.#skipResize = true;\n\t\t\tMenuSimplex.fixBackground(false);\n\t\t}\n\t}\n\n\tdoOnScroll(its) {\n\t\tif (!this.#curIts.length || !this.#curIts[0].popup) {\n\t\t\treturn;\n\t\t}\n\t\tconst bcr = this.#curIts[0].popup.getBoundingClientRect();\n\t\tif (\n\t\t\tbcr.bottom < 0 ||  // When not fixed\n\t\t\t(0 < bcr.top && bcr.bottom < Math.abs(window.scrollY - this.#scrollY))  // When fixed\n\t\t) {\n\t\t\tthis.closeAll(its);\n\t\t}\n\t}\n\n\talignItems(its, order) {\n\t\tthis.setMaxWidth();\n\t\tconst inBar = this.calcItemPlace(its, order);\n\n\t\tif (false === MenuSimplex.getStylePropertyBool(this.#divRoot, MenuSimplex.CP_IS_FOLDABLE)) {\n\t\t\tinBar.fill(true);\n\t\t\tinBar[this.#fldIdx] = false;\n\t\t}\n\t\tits[this.#fldIdx].li.style.display = inBar[this.#fldIdx] ? '' : 'none';\n\n\t\tlet prevElm = this.#ulBar.firstChild;\n\t\tfor (let i = 0; i < its.length; i += 1) {\n\t\t\tconst { li } = its[i];\n\t\t\tif (inBar[i]) {\n\t\t\t\tif (li.parentElement === this.#ulBar) {\n\t\t\t\t\tits[i].width = li.offsetWidth;\n\t\t\t\t}\n\t\t\t\tthis.#ulBar.insertBefore(li, prevElm.nextElementSibling);\n\t\t\t\tprevElm = li;\n\t\t\t} else if(i !== this.#fldIdx) {\n\t\t\t\tthis.#ulFld.appendChild(li);\n\t\t\t}\n\t\t}\n\t}\n\n\tsetMaxWidth() {\n\t\tconst p = this.#divRoot.parentElement;\n\t\tif (p) {\n\t\t\tconst s = getComputedStyle(p);\n\t\t\tconst w = p.clientWidth - (parseFloat(s.paddingLeft) + parseFloat(s.paddingRight));\n\t\t\tthis.#divRoot.style.setProperty(MenuSimplex.CP_MAX_WIDTH, `${Math.floor(w)}px`);\n\t\t}\n\t}\n\n\tcalcItemPlace(its, order) {\n\t\tconst inBar = new Array(its.length);\n\n\t\tconst gap  = this.calcBarGap();\n\t\tconst sumW = its.reduce((s, v) => s + v.width, 0) + (gap * (its.length - 1)) - (its[this.#fldIdx].width + gap);\n\t\tlet barW   = this.calcBarWidth();\n\n\t\tif (barW < sumW) {\n\t\t\tbarW -= its[this.#fldIdx].width;\n\t\t\tinBar[this.#fldIdx] = true;\n\n\t\t\tfor (const idx of order) {\n\t\t\t\tif (idx !== this.#fldIdx) {\n\t\t\t\t\tbarW -= its[idx].width + gap;\n\t\t\t\t\tinBar[idx] = (0 <= barW);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tinBar.fill(true);\n\t\t\tinBar[this.#fldIdx] = false;\n\t\t}\n\t\treturn inBar;\n\t}\n\n\tcalcBarWidth() {\n\t\tthis.#ulBar.style.width = '0';\n\t\tlet w = Math.floor(this.#divRoot.getBoundingClientRect().width);\n\n\t\tif (0 === w && this.#divRoot.parentElement) {\n\t\t\tconst s = getComputedStyle(this.#divRoot.parentElement);\n\t\t\tif (s.display.endsWith('flex')) {\n\t\t\t\tthis.#divRoot.style.flexGrow = '1';\n\t\t\t\tw = Math.floor(this.#divRoot.getBoundingClientRect().width);\n\t\t\t\tthis.#divRoot.style.flexGrow = '';\n\t\t\t}\n\t\t}\n\n\t\tthis.#ulBar.style.width = '';\n\t\treturn w;\n\t}\n\n\tcalcBarGap() {\n\t\tconst s = getComputedStyle(this.#ulBar);\n\t\tconst g = parseInt(s.columnGap, 10);\n\t\treturn Number.isNaN(g) ? 0 : g;\n\t}\n\n}\n"]}