{
  "version": 3,
  "sources": ["../src/menu-simplex.ts"],
  "sourcesContent": ["/**\n * Menu Simplex (Progressively collapsing menu)\n *\n * @author Takuto Yanagida\n * @version 2023-09-26\n */\n\nexport class MenuSimplex {\n\n\tstatic NS = 'menu-simplex';\n\n\tstatic CP_IS_CLOSED_AUTO = '--is-closed-auto';\n\tstatic CP_IS_BG_FIXED    = '--is-background-fixed';\n\tstatic CP_IS_REVERSED    = '--is-reversed';\n\tstatic CP_MORE_POS       = '--more-position';\n\tstatic CP_COLLAPSED      = '--collapsed';\n\n\tstatic CLS_MORE    = 'more';\n\tstatic CLS_CURRENT = 'current';\n\n\tstatic CLS_READY          = 'ready';\n\tstatic CLS_HOVER          = 'hover';\n\tstatic CLS_HOVER_ANCESTOR = 'hover-ancestor';\n\tstatic CLS_ACTIVE         = 'active';\n\tstatic CLS_OPENED         = 'opened';\n\n\tstatic CP_MAX_WIDTH = '--max-width';\n\n\n\t// -------------------------------------------------------------------------\n\n\n\tstatic throttle(fn: Function): () => void {\n\t\tlet isRunning: boolean;\n\t\tfunction run() {\n\t\t\tisRunning = false;\n\t\t\tfn();\n\t\t}\n\t\treturn () => {\n\t\t\tif (isRunning) return;\n\t\t\tisRunning = true;\n\t\t\trequestAnimationFrame(run);\n\t\t};\n\t}\n\n\tstatic addHoverStateEventListener(root: HTMLElement, elms: Element[]) {\n\t\tconst enter = (e: PointerEvent) => {\n\t\t\tconst li = (e.target as HTMLElement).parentElement;\n\n\t\t\tif (li && e.pointerType === 'mouse' && !li.classList.contains(MenuSimplex.CLS_CURRENT)) {\n\t\t\t\tli.classList.add(MenuSimplex.CLS_HOVER);\n\t\t\t\tfor (let elm = li.parentElement; elm && elm !== root; elm = elm.parentElement) {\n\t\t\t\t\tif (elm.tagName === 'LI') {\n\t\t\t\t\t\telm.classList.add(MenuSimplex.CLS_HOVER_ANCESTOR);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tconst leave = (e: PointerEvent) => {\n\t\t\tconst li = (e.target as HTMLElement).parentElement;\n\n\t\t\tif (li && e.pointerType === 'mouse' && !li.classList.contains(MenuSimplex.CLS_CURRENT)) {\n\t\t\t\tli.classList.remove(MenuSimplex.CLS_HOVER);\n\t\t\t\tfor (let elm = li.parentElement; elm && elm !== root; elm = elm.parentElement) {\n\t\t\t\t\tif (elm.tagName === 'LI') {\n\t\t\t\t\t\telm.classList.remove(MenuSimplex.CLS_HOVER_ANCESTOR);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (const it of elms) {\n\t\t\tconst fec = it.firstElementChild as HTMLElement;\n\t\t\tif (fec) {\n\t\t\t\tfec.addEventListener('pointerenter', enter);\n\t\t\t\tfec.addEventListener('pointerleave', leave);\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic fixed: boolean;\n\n\tstatic fixBackground(enabled: boolean) {\n\t\tif (MenuSimplex.fixed === enabled) return;\n\t\tMenuSimplex.fixed = enabled;\n\n\t\tconst scrollingElement = () => {\n\t\t\treturn ('scrollingElement' in document) ? document.scrollingElement : (<Document>document).documentElement;\n\t\t};\n\t\tconst se = scrollingElement();\n\t\tif (!se) return;\n\t\tconst sy = enabled ? se.scrollTop : parseInt(document.body.style.top ?? '0');\n\t\tconst cs = getComputedStyle(document.body);\n\t\tconst mw = parseFloat(cs.marginInlineStart) + parseFloat(cs.marginInlineEnd);\n\t\tconst ss = {\n\t\t\tposition: 'fixed',\n\t\t\ttop     : `${-sy}px`,\n\t\t\tleft    : '0',\n\t\t\twidth   : `calc(100vw - ${mw}px)`,\n\t\t\theight  : '100dvh',\n\n\t\t\t'overflow-y': 'scroll',  // For keeping scroll bar width.\n\t\t};\n\t\tfor (const [key, value] of Object.entries(ss)) {\n\t\t\t(document.body.style as any)[key] = enabled ? value : '';\n\t\t}\n\t\tif (!enabled) {\n\t\t\twindow.scrollTo(0, -sy);\n\t\t}\n\t}\n\n\tstatic getStylePropertyBool(elm: HTMLElement, prop: string): boolean|null {\n\t\tlet v = getComputedStyle(elm).getPropertyValue(prop).trim();\n\t\tif (('\"' === v.at(0) && '\"' === v.at(-1)) || (\"'\" === v.at(0) && \"'\" === v.at(-1))) {\n\t\t\tv = v.slice(1, -1);\n\t\t}\n\t\tif (!v.length) return null;\n\t\tif (typeof v !== 'string') return Boolean(v);\n\t\ttry {\n\t\t\treturn true === JSON.parse(v.toLowerCase());\n\t\t} catch(e) {\n\t\t\treturn v.length !== 0;\n\t\t}\n\t}\n\n\tstatic getStylePropertyString(elm: HTMLElement, prop: string): string|null {\n\t\tconst v = getComputedStyle(elm).getPropertyValue(prop).trim().replace(new RegExp('^\\\"+|\\\"+$', 'g'), '');\n\t\tif (!v.length) return null;\n\t\treturn (typeof v === 'string') ? v : String(v);\n\t}\n\n\n\t// -------------------------------------------------------------------------\n\n\n\t#divRoot    : HTMLElement;\n\t#ulBar      : HTMLElement;\n\t#ulMore     : HTMLElement;\n\t#liFocusTrap: HTMLElement;\n\n\t#moreIdx: number;\n\n\t#scrollY: number = 0;\n\t#curIts : Item[] = [];\n\n\t#skipResize: boolean = false;\n\n\tconstructor(id: string|null = null) {\n\t\tconst divRoot = id ? document.getElementById(id) : document.getElementsByClassName(MenuSimplex.NS)[0];\n\t\tif (!divRoot) throw new DOMException();\n\t\tthis.#divRoot = divRoot as HTMLElement;\n\t\tthis.#ulBar   = this.#divRoot.getElementsByTagName('ul')[0];\n\t\tif (!this.#ulBar) throw new DOMException();\n\n\t\tif (!this.#divRoot.classList.contains(MenuSimplex.NS)) {\n\t\t\tthis.#divRoot.classList.add(MenuSimplex.NS);\n\t\t}\n\n\t\t[this.#ulMore, this.#moreIdx] = this.initMore();\n\t\tconst its = this.initBarItems();\n\t\tthis.initPopup(its);\n\t\tconst order = this.initOrder(its);\n\t\tthis.#liFocusTrap = this.initFocusTrap();\n\n\t\tconst allLis = Array.from(this.#ulBar.querySelectorAll('li'));\n\t\tMenuSimplex.addHoverStateEventListener(this.#divRoot, allLis);\n\n\t\tsetTimeout(() => {\n\t\t\tconst ro = new ResizeObserver(\n\t\t\t\t() => requestAnimationFrame(() => {\n\t\t\t\t\tif (this.#skipResize) {\n\t\t\t\t\t\tthis.#skipResize = false;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis.closeAll(its);\n\t\t\t\t\tthis.alignItems(its, order);\n\t\t\t\t})\n\t\t\t);\n\t\t\tro.observe(this.#divRoot);\n\t\t\tro.observe(this.#divRoot.parentElement as HTMLElement);\n\t\t}, 10);\n\t\tsetTimeout(() => this.#divRoot.classList.add(MenuSimplex.CLS_READY), 100);\n\t}\n\n\tinitMore(): [HTMLElement, number] {\n\t\tlet li: HTMLElement|null = null;\n\t\tlet idx = 0;\n\t\tfor (const e of Array.from(this.#ulBar.children)) {\n\t\t\tif (e.classList.contains(MenuSimplex.CLS_MORE)) {\n\t\t\t\tli = e as HTMLElement;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tidx += 1;\n\t\t}\n\t\tif (!li) {\n\t\t\tli = document.createElement('li');\n\t\t\tli.classList.add(MenuSimplex.CLS_MORE);\n\n\t\t\tconst pos = MenuSimplex.getStylePropertyString(this.#divRoot, MenuSimplex.CP_MORE_POS);\n\t\t\tif (null === pos || 'end' === pos) {\n\t\t\t\tthis.#ulBar.append(li);\n\t\t\t\tidx = this.#ulBar.children.length - 1;\n\t\t\t} else if ('start' === pos) {\n\t\t\t\tthis.#ulBar.prepend(li);\n\t\t\t\tidx = 0;\n\t\t\t}\n\t\t}\n\t\tlet btn = li.querySelector(':scope > button');\n\t\tif (!btn) {\n\t\t\tbtn = document.createElement('button');\n\t\t\tbtn.setAttribute('title', 'More');\n\t\t\tli.insertBefore(btn, li.firstChild);\n\t\t}\n\t\tconst uls = li.querySelectorAll(':scope > ul, :scope > div > ul');\n\t\tlet ul = Array.from(uls).find(e => !e.children.length) as HTMLElement;\n\t\tif (!ul) {\n\t\t\tul = document.createElement('ul');\n\t\t\tul.classList.add('menu');\n\t\t\tconst div = li.querySelector(':scope > div');\n\t\t\tif (div) {\n\t\t\t\tdiv.appendChild(ul);\n\t\t\t} else {\n\t\t\t\tli.appendChild(ul);\n\t\t\t}\n\t\t}\n\t\treturn [ul, idx];\n\t}\n\n\tinitBarItems(): Item[] {\n\t\tconst its: Item[] = [];\n\t\tconst lis = Array.from(this.#ulBar.querySelectorAll(':scope > li'));\n\t\tfor (const li of lis) {\n\t\t\tconst btn = li.querySelector(':scope > button') as HTMLElement;\n\t\t\tconst popup = li.querySelector(':scope > :is(ul, div)') as HTMLElement;\n\t\t\tconst width = (li as HTMLElement).offsetWidth;\n\t\t\tits.push(new Item(li as HTMLElement, btn, popup, width));\n\t\t}\n\t\treturn its;\n\t}\n\n\tinitPopup(its: Item[]) {\n\t\tfor (const it of its) {\n\t\t\tconst { li, btn, popup } = it;\n\t\t\tif (!btn || !popup) continue;\n\n\t\t\tbtn.setAttribute('area-expanded', 'false');\n\t\t\tif (!popup.id) {\n\t\t\t\tconst id = btn.id ? btn.id : (li.id ? li.id : '');\n\t\t\t\tif (id) {\n\t\t\t\t\tpopup.id = id + '-sub';\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (popup.id) {\n\t\t\t\tbtn.setAttribute('area-controls', popup.id);\n\t\t\t}\n\t\t\tbtn.addEventListener('click', e => {\n\t\t\t\tif (btn.classList.contains(MenuSimplex.CLS_OPENED)) {\n\t\t\t\t\tthis.close(it);\n\t\t\t\t} else {\n\t\t\t\t\tif (this.#ulBar === li.parentElement) {\n\t\t\t\t\t\tthis.closeAll(its, btn);\n\t\t\t\t\t}\n\t\t\t\t\tthis.open(it);\n\t\t\t\t}\n\t\t\t\te.stopPropagation();\n\t\t\t});\n\t\t}\n\t\twindow.addEventListener('keydown', (e) => {\n\t\t\tif (e.key === 'Escape') {\n\t\t\t\tconst it = this.#curIts.at(-1);\n\t\t\t\tif (it) {\n\t\t\t\t\tconst { btn } = it;\n\t\t\t\t\tif (btn) {\n\t\t\t\t\t\tbtn.focus();\n\t\t\t\t\t\tbtn.click();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tif (MenuSimplex.getStylePropertyBool(this.#divRoot, MenuSimplex.CP_IS_CLOSED_AUTO)) {\n\t\t\tdocument.addEventListener('DOMContentLoaded', () => {\n\t\t\t\twindow.addEventListener('scroll', MenuSimplex.throttle(() => this.doOnScroll(its)), { passive: true });\n\t\t\t});\n\t\t\tdocument.addEventListener('click', () => this.closeAll(its));\n\t\t}\n\t}\n\n\tinitOrder(its: Item[]): number[] {\n\t\tconst rev = MenuSimplex.getStylePropertyBool(this.#divRoot, MenuSimplex.CP_IS_REVERSED);\n\n\t\tconst ws = new Array(its.length);\n\t\tfor (let i = 0; i < its.length; i += 1) {\n\t\t\tconst { li } = its[i];\n\t\t\tws[i] = this.getWeightFromClass(li, rev ? i : its.length - i);\n\t\t}\n\t\tconst order = new Array(its.length);\n\t\tfor (let i = 0; i < its.length; i += 1) order[i] = i;\n\t\torder.sort((a: number, b: number) => ws[a] < ws[b] ? 1 : ws[a] > ws[b] ? -1 : 0);\n\n\t\treturn order;\n\t}\n\n\tgetWeightFromClass(li: Element, def: number): number {\n\t\tconst cs = li.className.split(' ');\n\t\tlet w: number|null = null;\n\t\tfor (const c of cs) {\n\t\t\tconst n = parseInt(c, 10);\n\t\t\tif (isNaN(n)) continue;\n\t\t\tif (null === w || w < n) w = n;\n\t\t}\n\t\treturn w ?? def;\n\t}\n\n\tinitFocusTrap(): HTMLElement {\n\t\tconst e = document.createElement('li');\n\t\te.className = 'focus-trap';\n\t\te.tabIndex = 0;\n\t\te.addEventListener('focus', () => {\n\t\t\tif (this.#curIts.length) {\n\t\t\t\tconst { btn } = this.#curIts[0];\n\t\t\t\tif (btn) btn.focus();\n\t\t\t}\n\t\t});\n\t\treturn e;\n\t}\n\n\n\t// -------------------------------------------------------------------------\n\n\n\topen(it: Item) {\n\t\tconst { li, btn, popup } = it;\n\t\tif (!btn || !popup) return;\n\n\t\tli.classList.add(MenuSimplex.CLS_OPENED);\n\t\tbtn.classList.add(MenuSimplex.CLS_OPENED);\n\t\tbtn.setAttribute('area-expanded', 'true');\n\t\tpopup.classList.add(MenuSimplex.CLS_ACTIVE);\n\n\t\tsetTimeout(() => popup.classList.add(MenuSimplex.CLS_OPENED), 0);\n\t\tthis.#curIts.push(it);\n\n\t\tpopup.style.transform = '';\n\t\tif (this.#curIts[0].popup) {\n\t\t\tthis.adjustPopupInline(this.#curIts[0].popup);\n\t\t}\n\t\tthis.#scrollY = window.scrollY;\n\n\t\tif (1 === this.#curIts.length) {\n\t\t\tconst ul = ('UL' === popup.tagName) ? popup : popup.getElementsByTagName('ul')?.[0];\n\t\t\tif (ul) {\n\t\t\t\tul.appendChild(this.#liFocusTrap);\n\t\t\t}\n\t\t}\n\n\t\tif (MenuSimplex.getStylePropertyBool(this.#divRoot, MenuSimplex.CP_IS_BG_FIXED)) {\n\t\t\tthis.#skipResize = true;\n\t\t\tMenuSimplex.fixBackground(true);\n\t\t}\n\t}\n\n\tadjustPopupInline(popup: HTMLElement) {\n\t\tpopup.style.transform = '';\n\t\tpopup.style.maxWidth = '';\n\t\tlet pr = popup.getBoundingClientRect();\n\t\tconst rr = this.#divRoot.getBoundingClientRect();\n\t\tif (rr.width < pr.width) {\n\t\t\tpopup.style.maxWidth = `${rr.width}px`;\n\t\t\tpr = popup.getBoundingClientRect();\n\t\t}\n\t\tif (rr.right < pr.right) {\n\t\t\tpopup.style.transform = `translateX(${rr.right - pr.right}px)`;\n\t\t}\n\t\tif (pr.left < rr.left) {\n\t\t\tpopup.style.transform = `translateX(${pr.left - rr.left}px)`;\n\t\t}\n\t}\n\n\tclose(it: Item) {\n\t\tconst { li, btn, popup } = it;\n\t\tif (!btn || !popup) return;\n\n\t\tli.classList.remove(MenuSimplex.CLS_OPENED);\n\t\tbtn.classList.remove(MenuSimplex.CLS_OPENED);\n\t\tbtn.setAttribute('area-expanded', 'false');\n\t\tpopup.classList.remove(MenuSimplex.CLS_OPENED);\n\n\t\tsetTimeout(() => {\n\t\t\tpopup.classList.remove(MenuSimplex.CLS_ACTIVE);\n\t\t\tif (this.#curIts.length) {\n\t\t\t\tconst { popup } = this.#curIts[0];\n\t\t\t\tif (popup) this.adjustPopupInline(popup);\n\t\t\t}\n\t\t}, 200);\n\t\tthis.#curIts.pop();\n\n\t\tif (0 === this.#curIts.length) {\n\t\t\tconst ul = ('UL' === popup.tagName) ? popup : popup.getElementsByTagName('ul')?.[0];\n\t\t\tif (ul && this.#liFocusTrap.parentElement === ul) {\n\t\t\t\tul.removeChild(this.#liFocusTrap);\n\t\t\t}\n\t\t}\n\n\t\tif (MenuSimplex.getStylePropertyBool(this.#divRoot, MenuSimplex.CP_IS_BG_FIXED)) {\n\t\t\tthis.#skipResize = true;\n\t\t\tMenuSimplex.fixBackground(false);\n\t\t}\n\t}\n\n\tcloseAll(its: Item[], opening: HTMLElement|null = null) {\n\t\tif (!this.#curIts.length) return;\n\n\t\tfor (const it of its) {\n\t\t\tconst { btn } = it;\n\t\t\tif (btn && opening !== btn) {\n\t\t\t\tthis.close(it);\n\t\t\t}\n\t\t}\n\t\tthis.#curIts.length = 0;\n\n\t\tif (MenuSimplex.getStylePropertyBool(this.#divRoot, MenuSimplex.CP_IS_BG_FIXED)) {\n\t\t\tthis.#skipResize = true;\n\t\t\tMenuSimplex.fixBackground(false);\n\t\t}\n\t}\n\n\tdoOnScroll(its: Item[]) {\n\t\tif (!this.#curIts.length || !this.#curIts[0].popup) {\n\t\t\treturn;\n\t\t}\n\t\tconst bcr = this.#curIts[0].popup.getBoundingClientRect();\n\t\tif (\n\t\t\tbcr.bottom < 0 ||  // When not fixed\n\t\t\t(0 < bcr.top && bcr.bottom < Math.abs(window.scrollY - this.#scrollY))  // When fixed\n\t\t) {\n\t\t\tthis.closeAll(its);\n\t\t}\n\t}\n\n\talignItems(its: Item[], order: number[]) {\n\t\tthis.setMaxWidth();\n\t\tconst inBar = this.calcItemPlace(its, order);\n\t\tits[this.#moreIdx].li.style.display = inBar[this.#moreIdx] ? '' : 'none';\n\n\t\tlet prevElm = this.#ulBar.firstChild as HTMLElement;\n\t\tfor (let i = 0; i < its.length; i += 1) {\n\t\t\tconst { li } = its[i];\n\t\t\tif (inBar[i]) {\n\t\t\t\tif (li.parentElement === this.#ulBar) {\n\t\t\t\t\tits[i].width = li.offsetWidth;\n\t\t\t\t}\n\t\t\t\tthis.#ulBar.insertBefore(li, prevElm.nextElementSibling);\n\t\t\t\tprevElm = li;\n\t\t\t} else if(i !== this.#moreIdx) {\n\t\t\t\tthis.#ulMore.appendChild(li);\n\t\t\t}\n\t\t}\n\t}\n\n\tsetMaxWidth() {\n\t\tconst p = this.#divRoot.parentElement;\n\t\tif (p) {\n\t\t\tconst s = getComputedStyle(p);\n\t\t\tconst w = p.clientWidth - (parseFloat(s.paddingLeft) + parseFloat(s.paddingRight));\n\t\t\tthis.#divRoot.style.setProperty(MenuSimplex.CP_MAX_WIDTH, `${Math.floor(w)}px`);\n\t\t}\n\t}\n\n\tcalcItemPlace(its: Item[], order: number[]): boolean[] {\n\t\tconst inBar = new Array(its.length);\n\t\tswitch (MenuSimplex.getStylePropertyString(this.#divRoot, MenuSimplex.CP_COLLAPSED)) {\n\t\t\tcase 'never':\n\t\t\t\tinBar.fill(true);\n\t\t\t\tinBar[this.#moreIdx] = false;\n\t\t\t\treturn inBar;\n\t\t\tcase 'always':\n\t\t\t\tinBar.fill(false);\n\t\t\t\tinBar[this.#moreIdx] = true;\n\t\t\t\treturn inBar;\n\t\t}\n\n\t\tconst gap  = this.calcBarGap();\n\t\tconst sumW = its.reduce((s: number, v: Item) => s + v.width, 0) + (gap * (its.length - 1)) - (its[this.#moreIdx].width + gap);\n\t\tlet barW   = this.calcBarWidth();\n\n\t\tif (barW < sumW) {\n\t\t\tbarW -= its[this.#moreIdx].width;\n\t\t\tinBar[this.#moreIdx] = true;\n\n\t\t\tfor (const idx of order) {\n\t\t\t\tif (idx !== this.#moreIdx) {\n\t\t\t\t\tbarW -= its[idx].width + gap;\n\t\t\t\t\tinBar[idx] = (0 <= barW);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tinBar.fill(true);\n\t\t\tinBar[this.#moreIdx] = false;\n\t\t}\n\t\treturn inBar;\n\t}\n\n\tcalcBarWidth(): number {\n\t\tthis.#ulBar.style.width = '0';\n\t\tlet w = Math.floor(this.#divRoot.getBoundingClientRect().width);\n\n\t\tif (0 === w && this.#divRoot.parentElement) {\n\t\t\tconst s = getComputedStyle(this.#divRoot.parentElement);\n\t\t\tif (s.display.endsWith('flex')) {\n\t\t\t\tthis.#divRoot.style.flexGrow = '1';\n\t\t\t\tw = Math.floor(this.#divRoot.getBoundingClientRect().width);\n\t\t\t\tthis.#divRoot.style.flexGrow = '';\n\t\t\t}\n\t\t}\n\n\t\tthis.#ulBar.style.width = '';\n\t\treturn w;\n\t}\n\n\tcalcBarGap(): number {\n\t\tconst s = getComputedStyle(this.#ulBar);\n\t\tconst g = parseInt(s.columnGap, 10);\n\t\treturn Number.isNaN(g) ? 0 : g;\n\t}\n\n}\n\nclass Item {\n\n\tconstructor(public li:HTMLElement, public btn:HTMLElement|null, public popup:HTMLElement|null, public width: number) {\n\t\tthis.li    = li;\n\t\tthis.btn   = btn;\n\t\tthis.popup = popup;\n\t\tthis.width = width;\n\t}\n\n}\n"],
  "mappings": "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",
  "names": ["fn", "isRunning", "run", "root", "elms", "enter", "e", "li", "elm", "leave", "it", "fec", "enabled", "se", "sy", "cs", "mw", "ss", "key", "value", "prop", "v", "#divRoot", "#ulBar", "#ulMore", "#liFocusTrap", "#moreIdx", "#scrollY", "#curIts", "#skipResize", "id", "divRoot", "its", "order", "allLis", "ro", "idx", "pos", "btn", "uls", "ul", "div", "lis", "popup", "width", "Item", "rev", "ws", "a", "b", "def", "w", "c", "n", "pr", "rr", "opening", "bcr", "inBar", "prevElm", "p", "gap", "sumW", "s", "barW", "g"]
}
